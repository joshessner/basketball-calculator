<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basketball Ratings Calculator</title>
    
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Add basic styling to ensure content is visible -->
    <style>
        body {
            padding: 20px;
            font-family: system-ui, -apple-system, sans-serif;
        }
        #error-display {
            color: red;
            padding: 20px;
            border: 1px solid red;
            margin: 20px;
            display: none;
        }
    </style>
</head>
<body>
    <!-- Error display container -->
    <div id="error-display"></div>
    
    <!-- Root container -->
    <div id="root">
        <p>Loading calculator...</p>
    </div>

    <script type="text/babel">
        // Error handling
        window.onerror = function(msg, url, lineNo, columnNo, error) {
            const errorDisplay = document.getElementById('error-display');
            errorDisplay.style.display = 'block';
            errorDisplay.innerHTML = `
                <h3>An error occurred:</h3>
                <p>${msg}</p>
                <p>Line: ${lineNo}</p>
            `;
            return false;
        };

        // Your exported data goes here - replace with your actual data
       const TEAMS_DATA = {"Abilene Christian":{kpRating:-5.41,hca:2.8,espnRating:-5.5,bartO:98.9926561168664,bartD:103.710468074123,bartT:68.1759600785248},"Air Force":{kpRating:-12.48,hca:3.5,espnRating:-7.4,bartO:99.7051972449118,bartD:110.824661724526,bartT:63.8897254170017},"Akron":{kpRating:+7.78,hca:2.6,espnRating:3.4,bartO:113.961388306736,bartD:105.434409402766,bartT:71.3500022128615},"Alabama":{kpRating:+28.99,hca:3.6,espnRating:19.4,bartO:128.826294518178,bartD:97.6115509691026,bartT:73.9101776840948},"Alabama A&M":{kpRating:-22.32,hca:3.0,espnRating:-14.8,bartO:95.8719841124604,bartD:116.770193796874,bartT:70.7156555533332},"Alabama St.":{kpRating:-11.79,hca:2.3,espnRating:-8.4,bartO:102.990685365657,bartD:116.057223850477,bartT:67.6371452059906},"Albany":{kpRating:-8.93,hca:1.9,espnRating:-5.2,bartO:102.247692872483,bartD:112.808594366871,bartT:67.4945313538018},"Alcorn St.":{kpRating:-12.83,hca:2.9,espnRating:-10.0,bartO:97.7447316394349,bartD:108.559616359626,bartT:64.8617374935441},"American":{kpRating:-7.33,hca:2.1,espnRating:-4.8,bartO:103.815558460937,bartD:111.957460766023,bartT:63.1324227367869},"Appalachian St.":{kpRating:+2.70,hca:2.7,espnRating:1.2,bartO:103.905947000807,bartD:100.088335662129,bartT:63.6453267752601},"Arizona":{kpRating:+25.65,hca:3.4,espnRating:19.0,bartO:121.480748345585,bartD:94.9073779500486,bartT:70.2520285771955},"Arizona St.":{kpRating:+12.89,hca:3.0,espnRating:8.6,bartO:110.174361836134,bartD:98.1172854322465,bartT:67.875222863022}};
        // React Component
        function BasketballCalculator() {
            const [team1, setTeam1] = React.useState('');
            const [team2, setTeam2] = React.useState('');
            const [showDetails, setShowDetails] = React.useState(false);
            
            const teams = Object.keys(TEAMS_DATA).sort();
            
            const calculateResults = () => {
                if (!team1 || !team2) return null;
                
                const team1Data = TEAMS_DATA[team1];
                const team2Data = TEAMS_DATA[team2];
                
                const kenpomDiff = team1Data.kpRating - team2Data.kpRating;
                const espnDiff = team1Data.espnRating - team2Data.espnRating;
                const bartCalc = (team1Data.bartO / 107.3) * team2Data.bartD;
                const average = (kenpomDiff + espnDiff + bartCalc) / 3;
                
                return {
                    kenpom: kenpomDiff,
                    espn: espnDiff,
                    bart: bartCalc,
                    average: average,
                    team1Details: team1Data,
                    team2Details: team2Data
                };
            };

            const results = calculateResults();

            return (
                <div className="max-w-lg mx-auto p-6 bg-white">
                    <div className="space-y-6">
                        <div className="flex justify-between items-center">
                            <h2 className="text-xl font-semibold">Basketball Ratings Calculator</h2>
                            <div className="text-sm text-gray-500">
                                Last updated: {new Date().toLocaleDateString()}
                            </div>
                        </div>

                        <div className="flex flex-col space-y-4 sm:flex-row sm:space-x-4 sm:space-y-0">
                            <div className="flex-1">
                                <label className="block text-sm font-medium mb-2">First Team</label>
                                <select 
                                    value={team1} 
                                    onChange={(e) => setTeam1(e.target.value)}
                                    className="w-full p-2 border rounded-md bg-white"
                                >
                                    <option value="">Select a team</option>
                                    {teams.map(team => (
                                        <option key={team} value={team}>{team}</option>
                                    ))}
                                </select>
                            </div>

                            <div className="flex-1">
                                <label className="block text-sm font-medium mb-2">Second Team</label>
                                <select 
                                    value={team2} 
                                    onChange={(e) => setTeam2(e.target.value)}
                                    className="w-full p-2 border rounded-md bg-white"
                                >
                                    <option value="">Select a team</option>
                                    {teams.map(team => (
                                        <option key={team} value={team}>{team}</option>
                                    ))}
                                </select>
                            </div>
                        </div>

                        {results && (
                            <div className="space-y-4">
                                <div className="grid grid-cols-2 gap-4">
                                    <div className="p-4 bg-gray-50 rounded-md">
                                        <p className="text-sm font-medium text-gray-600">KenPom Difference</p>
                                        <p className="text-lg">{results.kenpom.toFixed(2)}</p>
                                    </div>
                                    <div className="p-4 bg-gray-50 rounded-md">
                                        <p className="text-sm font-medium text-gray-600">ESPN Difference</p>
                                        <p className="text-lg">{results.espn.toFixed(2)}</p>
                                    </div>
                                    <div className="p-4 bg-gray-50 rounded-md">
                                        <p className="text-sm font-medium text-gray-600">Bart Rating</p>
                                        <p className="text-lg">{results.bart.toFixed(2)}</p>
                                    </div>
                                    <div className="p-4 bg-blue-50 rounded-md">
                                        <p className="text-sm font-medium text-blue-600">Average</p>
                                        <p className="text-lg">{results.average.toFixed(2)}</p>
                                    </div>
                                </div>

                                <button
                                    onClick={() => setShowDetails(!showDetails)}
                                    className="text-sm text-blue-600 hover:text-blue-800"
                                >
                                    {showDetails ? 'Hide Details' : 'Show Details'}
                                </button>

                                {showDetails && (
                                    <div className="grid grid-cols-2 gap-4 mt-4 text-sm">
                                        <div className="p-4 bg-gray-50 rounded-md">
                                            <h3 className="font-medium mb-2">{team1}</h3>
                                            <div className="space-y-1">
                                                <p>KP Rating: {results.team1Details.kpRating}</p>
                                                <p>ESPN Rating: {results.team1Details.espnRating}</p>
                                                <p>Bart O: {results.team1Details.bartO}</p>
                                                <p>Bart D: {results.team1Details.bartD}</p>
                                            </div>
                                        </div>
                                        <div className="p-4 bg-gray-50 rounded-md">
                                            <h3 className="font-medium mb-2">{team2}</h3>
                                            <div className="space-y-1">
                                                <p>KP Rating: {results.team2Details.kpRating}</p>
                                                <p>ESPN Rating: {results.team2Details.espnRating}</p>
                                                <p>Bart O: {results.team2Details.bartO}</p>
                                                <p>Bart D: {results.team2Details.bartD}</p>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Wrap the render in a try-catch
        try {
            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(<BasketballCalculator />);
        } catch (error) {
            const errorDisplay = document.getElementById('error-display');
            errorDisplay.style.display = 'block';
            errorDisplay.innerHTML = `
                <h3>Failed to start calculator:</h3>
                <p>${error.message}</p>
            `;
        }
    </script>
</body>
</html>
